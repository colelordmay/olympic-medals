import numpy as np
import pandas as pd
import pickle

### Conversion dictionary to ISO3a
ioc_to_iso3 = {
    "AFG": "AFG",
    "ALB": "ALB",
    "ALG": "DZA",
    "AND": "AND",
    "ANG": "AGO",
    "ANT": "ATG",
    "ARG": "ARG",
    "ARM": "ARM",
    "ARU": "ABW",
    "ASA": "ASM",
    "AUS": "AUS",
    "AUT": "AUT",
    "AZE": "AZE",
    "BAH": "BHS",
    "BAN": "BGD",
    "BAR": "BRB",
    "BDI": "BDI",
    "BEL": "BEL",
    "BEN": "BEN",
    "BER": "BMU",
    "BHU": "BTN",
    "BIH": "BIH",
    "BIZ": "BLZ",
    "BLR": "BLR",
    "BOL": "BOL",
    "BOT": "BWA",
    "BRA": "BRA",
    "BRN": "BRN",
    "BRU": "BRU",
    "BUL": "BGR",
    "BUR": "BFA",
    "CAF": "CAF",
    "CAM": "KHM",
    "CAN": "CAN",
    "CAY": "CYM",
    "CGO": "COG",
    "CHA": "TCD",
    "CHI": "CHL",
    "CHN": "CHN",
    "CIV": "CIV",
    "CMR": "CMR",
    "COD": "COD",
    "COK": "COK",
    "COL": "COL",
    "COM": "COM",
    "CPV": "CPV",
    "CRC": "CRI",
    "CRO": "HRV",
    "CUB": "CUB",
    "CYP": "CYP",
    "CZE": "CZE",
    "DEN": "DNK",
    "DJI": "DJI",
    "DMA": "DMA",
    "DOM": "DOM",
    "ECU": "ECU",
    "EGY": "EGY",
    "ERI": "ERI",
    "ESA": "SLV",
    "ESP": "ESP",
    "EST": "EST",
    "ETH": "ETH",
    "FIJ": "FJI",
    "FIN": "FIN",
    "FRA": "FRA",
    "FSM": "FSM",
    "GAB": "GAB",
    "GAM": "GMB",
    "GBR": "GBR",
    "GBS": "GNB",
    "GEO": "GEO",
    "GER": "DEU",
    "GHA": "GHA",
    "GRE": "GRC",
    "GRN": "GRD",
    "GUA": "GTM",
    "GUI": "GIN",
    "GUM": "GUM",
    "GUY": "GUY",
    "HAI": "HTI",
    "HKG": "HKG",
    "HON": "HND",
    "HUN": "HUN",
    "INA": "IDN",
    "IND": "IND",
    "IRI": "IRN",
    "IRL": "IRL",
    "IRQ": "IRQ",
    "ISL": "ISL",
    "ISR": "ISR",
    "ISV": "VIR",
    "ITA": "ITA",
    "IVB": "IVB",
    "JAM": "JAM",
    "JOR": "JOR",
    "JPN": "JPN",
    "KAZ": "KAZ",
    "KEN": "KEN",
    "KGZ": "KGZ",
    "KIR": "KIR",
    "KOR": "KOR",
    "KSA": "SAU",
    "KUW": "KWT",
    "LAO": "LAO",
    "LAT": "LVA",
    "LBA": "LBY",
    "LBR": "LBR",
    "LES": "LSO",
    "LIE": "LIE",
    "LTU": "LTU",
    "LUX": "LUX",
    "MAD": "MDG",
    "MAR": "MAR",
    "MAS": "MYS",
    "MAW": "MWI",
    "MDA": "MDA",
    "MDV": "MDV",
    "MEX": "MEX",
    "MGL": "MNG",
    "MRI": "MRT",
    "MTN": "MRT",
    "MYA": "MMR",
    "NAM": "NAM",
    "NCA": "NIC",
    "NED": "NLD",
    "NEP": "NPL",
    "NGR": "NGA",
    "NIG": "NER",
    "NOR": "NOR",
    "NRU": "NRU",
    "NZL": "NZL",
    "OMA": "OMN",
    "PAK": "PAK",
    "PAN": "PAN",
    "PAR": "PRY",
    "PER": "PER",
    "PHI": "PHL",
    "PLE": "PSE",
    "PLW": "PLW",
    "PNG": "PNG",
    "POL": "POL",
    "POR": "PRT",
    "PRK": "PRK",
    "PUR": "PUR",
    "QAT": "QAT",
    "ROU": "ROU",
    "RSA": "ZAF",
    "RUS": "RUS",
    "RWA": "RWA",
    "SAM": "WSM",
    "SEN": "SEN",
    "SGP": "SGP",
    "SKN": "KNA",
    "SLE": "SLE",
    "SLO": "SVN",
    "SMR": "SMR",
    "SOL": "SLB",
    "SOM": "SOM",
    "SRB": "SRB",
    "SRI": "LKA",
    "SSD": "SSD",
    "STP": "STP",
    "SUD": "SDN",
    "SUI": "CHE",
    "SUR": "SUR",
    "SVK": "SVK",
    "SWE": "SWE",
    "SWZ": "SWZ",
    "SYR": "SYR",
    "TAN": "TZA",
    "TGA": "TON",
    "THA": "THA",
    "TJK": "TJK",
    "TKM": "TKM",
    "TLS": "TLS",
    "TOG": "TGO",
    "TPE": "TPE",
    "TTO": "TTO",
    "TUN": "TUN",
    "TUR": "TUR",
    "UAE": "ARE",
    "UGA": "UGA",
    "UKR": "UKR",
    "URU": "URY",
    "USA": "USA",
    "UZB": "UZB",
    "VAN": "VUT",
    "VEN": "VEN",
    "VIE": "VNM",
    "VIN": "VCT",
    "YEM": "YEM",
    "ZAM": "ZMB",
    "ZIM": "ZWE",
}

T = pickle.load(open("medal_data.pickle","rb"))
summer_men_g,summer_men_s,summer_men_b,summer_women_g,summer_women_s,summer_women_b,winter_men_g,winter_men_s,winter_men_b,winter_women_g,winter_women_s,winter_women_b = T

men_s = (summer_men_g + summer_men_s + summer_men_b).sum(axis=0)
men_w = (winter_men_g + winter_men_s + winter_men_b).sum(axis=0)
women_s = (summer_women_g + summer_women_s + summer_women_b).sum(axis=0)
women_w = (winter_women_g + winter_women_s + winter_women_b).sum(axis=0)

summer_r = (women_s/(women_s + men_s))
summer_r[summer_r.isnull()] = 0.0
summer_t = women_s + men_s

winter_r = (women_w/(women_w + men_w))
winter_r[winter_r.isnull()] = 0.0
winter_t = women_w + men_w

all_r = ((women_w+women_s)/(women_w + men_w + women_s + men_s))
all_r[all_r.isnull()] = 0.0
all_t = women_w + men_w + women_s + men_s





S = pd.DataFrame({"ratio":summer_r,"total":summer_t})
S['iso3'] = S.index.map(ioc_to_iso3)
S = S.set_index('iso3')
S.to_csv("summer_counts.csv",index=True,index_label="country")

S = pd.DataFrame({"ratio":winter_r,"total":winter_t})
S['iso3'] = S.index.map(ioc_to_iso3)
S = S.set_index('iso3')
S.to_csv("winter_counts.csv",index=True,index_label="country")

S = pd.DataFrame({"ratio":all_r,"total":all_t})
S['iso3'] = S.index.map(ioc_to_iso3)
S = S.set_index('iso3')
S.to_csv("both_counts.csv",index=True,index_label="country")